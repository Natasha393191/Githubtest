<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>統計分析 - 正念覺察筆記</title>
    <link rel="stylesheet" href="./css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- 響應式導航系統 -->
    <nav class="navbar">
        <div class="nav-container">
            <!-- Logo區域 -->
            <div class="nav-logo">
                <a href="index.html" class="logo-link">
                    <span class="logo-icon">🧘</span>
                    <span class="logo-text">正念覺察</span>
                </a>
            </div>

            <!-- 主要導航選單 -->
            <ul class="nav-menu" id="navMenu">
                <li class="nav-item">
                    <a href="index.html" class="nav-link">
                        <span class="nav-icon">🏠</span>
                        <span class="nav-text">首頁</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="journal.html" class="nav-link">
                        <span class="nav-icon">📝</span>
                        <span class="nav-text">記錄冥想</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="history.html" class="nav-link">
                        <span class="nav-icon">📚</span>
                        <span class="nav-text">歷史回顧</span>
                    </a>
                </li>
                <li class="nav-item">
                                <a href="stats.html" class="nav-link active">
                <span class="nav-icon">📊</span>
                <span class="nav-text">統計分析</span>
            </a>
            <a href="settings.html" class="nav-link">
                <span class="nav-icon">⚙️</span>
                <span class="nav-text">設定</span>
            </a>
                </li>
            </ul>

            <!-- 漢堡選單按鈕 -->
            <button class="hamburger" id="hamburger" aria-label="開啟選單">
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
            </button>
        </div>
    </nav>

    <!-- 主要內容區域 -->
    <main class="main-content">
        <div class="container">
            <!-- 頁面標題 -->
            <header class="page-header">
                <h2>統計分析</h2>
                <p>透過數據了解您的正念覺察旅程，發現內在的成長軌跡</p>
            </header>

            <!-- 時間範圍選擇 -->
            <section class="time-range-section">
                <div class="time-controls">
                    <label for="time-range">選擇時間範圍：</label>
                    <select id="time-range" class="time-select">
                        <option value="7">最近7天</option>
                        <option value="30" selected>最近30天</option>
                        <option value="90">最近3個月</option>
                        <option value="365">最近一年</option>
                        <option value="all">全部記錄</option>
                    </select>
                    <button class="btn btn-primary" onclick="updateAllCharts()">
                        <span class="btn-icon">🔄</span>
                        <span class="btn-text">更新圖表</span>
                    </button>
                </div>
            </section>

            <!-- 概覽統計卡片 -->
            <section class="overview-stats">
                <h3>📊 概覽統計</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">📅</div>
                        <div class="stat-content">
                            <h4>總冥想次數</h4>
                            <p class="stat-number" id="totalSessions">0</p>
                            <p class="stat-change" id="sessionsChange">本週 +0</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">⏱️</div>
                        <div class="stat-content">
                            <h4>總冥想時長</h4>
                            <p class="stat-number" id="totalDuration">0 小時</p>
                            <p class="stat-change" id="durationChange">本週 +0 小時</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">🔥</div>
                        <div class="stat-content">
                            <h4>連續冥想天數</h4>
                            <p class="stat-number" id="streakDays">0 天</p>
                            <p class="stat-change" id="streakChange">最長 0 天</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">📈</div>
                        <div class="stat-content">
                            <h4>平均情緒改善</h4>
                            <p class="stat-number" id="avgMoodImprovement">0</p>
                            <p class="stat-change" id="moodChange">較上期 +0</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">🎯</div>
                        <div class="stat-content">
                            <h4>本月冥想時數</h4>
                            <p class="stat-number" id="monthlyHours">0 小時</p>
                            <p class="stat-change" id="monthlyChange">目標 20 小時</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">🌟</div>
                        <div class="stat-content">
                            <h4>最常用冥想類型</h4>
                            <p class="stat-number" id="favoriteType">-</p>
                            <p class="stat-change" id="typeChange">使用 0 次</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 情緒變化趨勢圖 -->
            <section class="mood-trend-section">
                <div class="chart-container">
                    <h3>😌 情緒變化趨勢（最近30天）</h3>
                    <p class="chart-description">
                        觀察您冥想前後的情緒變化，了解正念練習對您內在平靜的影響。
                        綠色線條代表冥想後的情緒，藍色線條代表冥想前的情緒。
                    </p>
                    <div class="chart-wrapper">
                        <canvas id="moodTrendChart" width="800" height="400"></canvas>
                    </div>
                    <div class="chart-insights">
                        <div class="insight-item">
                            <span class="insight-icon">📊</span>
                            <span class="insight-text">平均情緒改善：<strong id="trendImprovement">0</strong> 分</span>
                        </div>
                        <div class="insight-item">
                            <span class="insight-icon">📈</span>
                            <span class="insight-text">最佳改善日：<strong id="bestDay">-</strong></span>
                        </div>
                        <div class="insight-item">
                            <span class="insight-icon">🎯</span>
                            <span class="insight-text">建議：<span id="moodSuggestion">繼續保持每日冥想習慣</span></span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 冥想時長統計 -->
            <section class="duration-analysis">
                <div class="analysis-grid">
                    <div class="analysis-card">
                        <h3>⏰ 冥想時長分布</h3>
                        <p class="chart-description">
                            了解您偏好的冥想時長，幫助您找到最適合的練習節奏。
                        </p>
                        <div class="chart-wrapper">
                            <canvas id="durationPieChart" width="400" height="300"></canvas>
                        </div>
                        <div class="chart-insights">
                            <div class="insight-item">
                                <span class="insight-icon">🎯</span>
                                <span class="insight-text">最常用時長：<strong id="mostUsedDuration">-</strong></span>
                            </div>
                            <div class="insight-item">
                                <span class="insight-icon">📊</span>
                                <span class="insight-text">平均時長：<strong id="avgDuration">-</strong> 分鐘</span>
                            </div>
                        </div>
                    </div>
                    <div class="analysis-card">
                        <h3>🧘 冥想類型分布</h3>
                        <p class="chart-description">
                            探索您最常使用的冥想類型，了解哪些練習方式最適合您。
                        </p>
                        <div class="chart-wrapper">
                            <canvas id="typeBarChart" width="400" height="300"></canvas>
                        </div>
                        <div class="chart-insights">
                            <div class="insight-item">
                                <span class="insight-icon">⭐</span>
                                <span class="insight-text">最愛類型：<strong id="favoriteMeditationType">-</strong></span>
                            </div>
                            <div class="insight-item">
                                <span class="insight-icon">🔄</span>
                                <span class="insight-text">建議嘗試：<strong id="suggestedType">-</strong></span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 每週冥想頻率 -->
            <section class="weekly-frequency-section">
                <div class="chart-container">
                    <h3>📅 每週冥想頻率</h3>
                    <p class="chart-description">
                        觀察您的冥想習慣模式，了解哪些時段最適合您的正念練習。
                        這有助於建立更規律的冥想習慣。
                    </p>
                    <div class="chart-wrapper">
                        <canvas id="weeklyFrequencyChart" width="800" height="400"></canvas>
                    </div>
                    <div class="chart-insights">
                        <div class="insight-item">
                            <span class="insight-icon">📊</span>
                            <span class="insight-text">最常冥想日：<strong id="mostActiveDay">-</strong></span>
                        </div>
                        <div class="insight-item">
                            <span class="insight-icon">🎯</span>
                            <span class="insight-text">建議：<span id="frequencySuggestion">保持每日冥想習慣</span></span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 思緒類型分析 -->
            <section class="thought-analysis-section">
                <div class="chart-container">
                    <h3>💭 觀察到的思緒類型</h3>
                    <p class="chart-description">
                        了解您在冥想過程中觀察到的思緒模式，這有助於您更好地理解自己的內心世界。
                    </p>
                    <div class="chart-wrapper">
                        <canvas id="thoughtTypeChart" width="800" height="400"></canvas>
                    </div>
                    <div class="chart-insights">
                        <div class="insight-item">
                            <span class="insight-icon">🧠</span>
                            <span class="insight-text">最常見思緒：<strong id="mostCommonThought">-</strong></span>
                        </div>
                        <div class="insight-item">
                            <span class="insight-icon">💡</span>
                            <span class="insight-text">洞察：<span id="thoughtInsight">觀察思緒而不評判是正念的核心</span></span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 個人洞察與建議 -->
            <section class="personal-insights-section">
                <h3>💡 個人洞察與建議</h3>
                <div class="insights-grid">
                    <div class="insight-card">
                        <div class="insight-icon">🌅</div>
                        <h4>最佳冥想時段</h4>
                        <p id="bestTimeInsight">根據您的數據分析，建議在早晨進行冥想練習，此時心境最為平靜。</p>
                    </div>
                    <div class="insight-card">
                        <div class="insight-icon">📈</div>
                        <h4>進步趨勢</h4>
                        <p id="progressInsight">您的正念練習正在穩步提升，情緒管理能力有明顯改善。</p>
                    </div>
                    <div class="insight-card">
                        <div class="insight-icon">🎯</div>
                        <h4>專注度建議</h4>
                        <p id="focusInsight">建議嘗試不同的冥想類型，找到最適合您的練習方式。</p>
                    </div>
                    <div class="insight-card">
                        <div class="insight-icon">💝</div>
                        <h4>一致性提醒</h4>
                        <p id="consistencyInsight">保持每日冥想的習慣比時長更重要，建議設定固定的冥想時間。</p>
                    </div>
                    <div class="insight-card">
                        <div class="insight-icon">🌟</div>
                        <h4>成就里程碑</h4>
                        <p id="achievementInsight">恭喜您已經建立了穩定的正念練習習慣！</p>
                    </div>
                    <div class="insight-card">
                        <div class="insight-icon">🔄</div>
                        <h4>下一步建議</h4>
                        <p id="nextStepInsight">考慮增加冥想時長或嘗試新的冥想技巧來深化練習。</p>
                    </div>
                </div>
            </section>

            <!-- 數據匯出 -->
            <section class="export-section">
                <h3>📤 匯出與分享</h3>
                <div class="export-options">
                    <button class="btn btn-primary" onclick="exportPDF()">
                        <span class="btn-icon">📄</span>
                        <span class="btn-text">下載 PDF 報告</span>
                    </button>
                    <button class="btn btn-secondary" onclick="exportCSV()">
                        <span class="btn-icon">📊</span>
                        <span class="btn-text">下載 CSV 數據</span>
                    </button>
                    <button class="btn btn-secondary" onclick="shareReport()">
                        <span class="btn-icon">📤</span>
                        <span class="btn-text">分享報告</span>
                    </button>
                    <button class="btn btn-secondary" onclick="resetData()">
                        <span class="btn-icon">🗑️</span>
                        <span class="btn-text">清除所有數據</span>
                    </button>
                </div>
            </section>
        </div>
    </main>

    <!-- 頁腳 -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2024 正念覺察筆記. 與內在對話的寧靜空間.</p>
        </div>
    </footer>

    <!-- Chart.js 圖表庫 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="./js/main.js"></script>
    <script src="./js/stats.js"></script>
</body>
</html>